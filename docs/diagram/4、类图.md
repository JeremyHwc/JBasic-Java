[toc]

## 1、类图是什么（what）

### 1.1 定义

类图是软件工程的统一建模语言中的一种静态结构图，该图描述**系统中类的结构、类与类之间的关系**。

## 2、为什么要使用类图（why）

- 手册设计规约章节，对类图有下面的规定：

  > 【强制】如果系统中模型类超过5个，并且存在复杂的依赖关系，使用功能类图来表达并明确类之间的关系。

- 类图可以让我们从整体的视角来审视整个系统；

- 在需求详细设计阶段，方便团队成员之间沟通方案细节实现。

## 3、类图使用场景（when）

- 通常用在**软件生命周期的详细设计阶段**；
- 学习和研究系统源码

## 4、如何画类图（how）

### 4.1 基本组件

![](imgs\classdiagram\basic_structure.jpg)

- 类名
- 属性，表现形式为 **可见性 属性名称：属性类型**。如 - content : String，等价于private String content;
- 操作，表现形式为 **可见性 函数名称：返回值类型**。

### 4.2 关系

类与类之间主要存在5种关系，包括依赖关系、关联关系、聚合关系、组合关系、泛化关系。简称**依关聚组泛**。

#### 4.2.1 依赖关系

依赖关系是五中关系中耦合最小的一种关系，如类A要完成某种功能引用了类B，那么A就依赖了B，如类A的成员函数的返回值、参数、局部变量或静态方法调用使用了B。**依赖关系的生命周期较短，一般在方法调用期间存在。**

![](imgs\classdiagram\dependency.jpg )

#### 4.2.2 关联关系

关联关系的声明周期更长，随着类的初始化而产生，随着对象的销毁而结束。

##### 4.2.2.1 单项关联

用带箭头的实线表示。关联关系表示类比较强的依赖，且这种关系由一方来维护，如学生依赖老师，学生类中有一个老师的成员属性。

![](imgs\classdiagram\one_way_dependency.jpg)

##### 4.2.2.2 双向关联

通过实线连接，表示两个类相互引用。

![](imgs\classdiagram\interdependence.jpg)

#### 4.2.3 聚合关系

表示**集体和个体的关系**。是一种“**has-a**”的关系。如班级和学生、公司和员工之间就是聚合关系。

用**空心菱形加实心线**表示。

![](imgs\classdiagram\paradigmatic_relation.jpg)

#### 4.2.4 组合关系

组合关系是关联关系的一种特例，表示整体及其组成部分的关系，是一种“**contaions-a**”的关系。如人作为一个整体，包括头部、腹部、腿部等组成部分。

![](imgs\classdiagram\combinational_relationships.jpg)

#### 4.2.5 泛化关系

指类与类之间的继承关系以及类与接口之间的实现关系。以Integer为例。

实现接口通过“**空心箭头 + 虚线**”表示

继承类通过 “**空心箭头 + 实线**”表示

### 4.3 数量关系

- 1表示只有一个；
- 0 .. 1表示0个或者1个；
- *表示多个；
- 0 .. *表示0个或多个；
- 1 .. *表示1个或多个；

例如一个班级有一个或多个学生

![](imgs\classdiagram\number_relationships.jpg)

### 4.4 可见性

- 公有（public），用“**+**”表示；
- 受保护（protected）,用“**#**”表示；
- 包私有（package private）,用“**~**”表示；
- 私有（private），用“**-**”表示

![](imgs\classdiagram\visibility.jpg)

## 4、类图案例

> 一个**交易系统**中主要包括**顾客**、**订单**、**订单详情**、**商品**、**支付**等核心类。其中
>
> **顾客的属性**主要包括顾客的姓名、收货地址、联系方式和是否活跃。
>
> **订单的属性**主要包括订单的创建日期，订单详情、订单的状态、支付方式。订单的支付方式可以有多种，如信用卡、现金、支票、转账。订单的状态包括创建状态、海运中、投递完成和支付完成这几个状态。
>
> **订单详情**主要包括商品数量，税信息，订单详情类还要提供计算总金额和重量的功能。订单详情中包含商品，商品有重量和描述信息，商品对象中要提供获取商品重量的接口，还要提供根据重量获取价格的功能。

**根据上述描述可以绘制出核心的类、属性和行为，然后再去梳理类之间的关系。**

类之间的关系需要通过需求或者常识得出。一个顾客可能未下单，即有零个订单，也可能多次下单从而产生多个订单。一个订单只有一种状态，因此订单和状态之间是一对一的关系。由于支持多种支付方式，因此订单和支付方式之间是一对多的关系。支付方式可以是一个抽象类，每种具体的支付方式是其实现类，因此它们之间是泛化关系。订单必然订单项，最少为一个。而一个商品有可能被一次或多次下单而成为订单项，也可能没有被下单过，因此一个商品可能对应零个或者多个订单订单项。

![](imgs\classdiagram\class_diagram_example.jpg)